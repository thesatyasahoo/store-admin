import{r as f,S as J,c as Q,j as e,d as p,L as q}from"./index-njudL7fz.js";import{u as z,S as W,I as X}from"./Layout-JsXqKSFR.js";import{T as Z,C as y,S as ee}from"./BulkActionDrawer-CbBQchGQ.js";import{T as K,D as se,u as ae,M as te}from"./DrawerButton-BUY6Djek.js";import{D as ne,E as re}from"./EditDeleteButton-BUM0uXoF.js";import{T as le}from"./ParentCategory-BNQd-o5V.js";import{a as B,n as $}from"./toast-DX8d8eRH.js";import{u as ie,E as k}from"./index.esm-2x07zYBF.js";import{I as de}from"./InputArea-De5Z0P_G.js";import{L}from"./LabelArea-B72Uma4d.js";import{S as oe}from"./SwitchToggle-D-nBAwTv.js";import{U as me}from"./Uploader-BigpkR8P.js";import{C as P}from"./ProductServices-D2PrCWjo.js";const pe=(o,c)=>{const{isDrawerOpen:t,closeDrawer:j,setIsUpdate:x,lang:S}=f.useContext(J),[v,C]=f.useState({}),[b,w]=f.useState(""),[D,u]=f.useState(""),[_,s]=f.useState([]),[r,h]=f.useState(S),[m,T]=f.useState(!0),[A,E]=f.useState(""),[U,N]=f.useState(!1),{register:H,handleSubmit:a,setValue:n,clearErrors:l,reset:I,formState:{errors:F}}=ie(),M=d=>{for(const i in d)d[i].trim()===""&&delete d[i];return d},Y=async({name:d,description:i})=>{var R,V;try{N(!0);const g={name:M({[r]:d}),description:M({[r]:i||""}),parentId:b||void 0,parentName:A||"Home",icon:D,status:m?"show":"hide",lang:r};if(o){const O=await P.updateCategory(o,g);x(!0),N(!1),$(O.message),j(),I()}else{const O=await P.addCategory(g);x(!0),N(!1),$(O.message),j()}}catch(g){N(!1),B(g?(V=(R=g==null?void 0:g.response)==null?void 0:R.data)==null?void 0:V.message:g==null?void 0:g.message),j()}},G=d=>{h(d),Object.keys(v).length>0&&(n("name",v.name[d||"en"]),n("description",v.description[d||"en"]))};return f.useEffect(()=>{var d;if(!t){C({}),n("name"),n("parentId"),n("parentName"),n("description"),n("icon"),u(""),T(!0),l("name"),l("parentId"),l("parentName"),l("description"),E("Home"),h(S),n("language",r),c!==void 0&&((d=c[0])==null?void 0:d._id)!==void 0&&w(c[0]._id);return}o&&(async()=>{try{const i=await P.getCategoryById(o);i&&(C(i),n("name",i.name[r||"en"]),n("description",i.description[r||"en"]),n("language",r),n("parentId",i.parentId),n("parentName",i.parentName),E(i.parentName),w(i.parentId),u(i.icon),T(i.status==="show"))}catch(i){B(i?i.response.data.message:i.message)}})()},[o,n,t,r,l,c,S]),{register:H,handleSubmit:a,onSubmit:Y,errors:F,imageUrl:D,setImageUrl:u,children:_,setChildren:s,published:m,setPublished:T,checked:b,setChecked:w,isSubmitting:U,selectCategoryName:A,setSelectCategoryName:E,handleSelectLanguage:G}},ce=({id:o,data:c})=>{const{t}=Q(),{checked:j,register:x,onSubmit:S,handleSubmit:v,errors:C,imageUrl:b,setImageUrl:w,published:D,setPublished:u,setChecked:_,selectCategoryName:s,setSelectCategoryName:r,handleSelectLanguage:h,isSubmitting:m}=pe(o,c),{showingTranslateValue:T}=z(),A=`
  .rc-tree-child-tree {
    display: hidden;
  }
  .node-motion {
    transition: all .3s;
    overflow-y: hidden;
  }
`,E={motionName:"node-motion",motionAppear:!1,onAppearStart:a=>({height:0}),onAppearActive:a=>({height:a.scrollHeight}),onLeaveStart:a=>({height:a.offsetHeight}),onLeaveActive:()=>({height:0})},U=a=>{let n=[];for(let l of a)n.push({title:T(l.name),key:l._id,children:l.children.length>0&&U(l.children)});return n},N=(a,n)=>{var l;return a._id===n?a:(l=a==null?void 0:a.children)==null?void 0:l.reduce((I,F)=>I??N(F,n),void 0)},H=async a=>{if(a!==void 0)if(o){const n=await P.getCategoryById(a);if(o===a)return B("This can't be select as a parent category!");if(o===n.parentId)return B("This can't be select as a parent category!");{if(a===void 0)return;_(a);const l=c[0],I=N(l,a);r(T(I==null?void 0:I.name))}}else{if(a===void 0)return;_(a);const n=c[0],l=N(n,a);r(T(l==null?void 0:l.name))}};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-full relative p-6 border-b border-gray-100 bg-gray-50 dark:border-gray-700 dark:bg-gray-800 dark:text-gray-300",children:o?e.jsx(K,{register:x,handleSelectLanguage:h,title:t("UpdateCategory"),description:t("UpdateCategoryDescription")}):e.jsx(K,{register:x,handleSelectLanguage:h,title:t("AddCategoryTitle"),description:t("AddCategoryDescription")})}),e.jsx(W,{className:"w-full md:w-7/12 lg:w-8/12 xl:w-8/12 relative dark:bg-gray-700 dark:text-gray-200",children:e.jsxs("form",{onSubmit:v(S),children:[e.jsxs("div",{className:"p-6 flex-grow scrollbar-hide w-full max-h-full pb-40",children:[e.jsxs("div",{className:"grid grid-cols-6 gap-3 md:gap-5 xl:gap-6 lg:gap-6 mb-6",children:[e.jsx(L,{label:t("Name")}),e.jsxs("div",{className:"col-span-8 sm:col-span-4",children:[e.jsx(de,{required:!0,register:x,label:"Category title",name:"name",type:"text",placeholder:t("ParentCategoryPlaceholder")}),e.jsx(k,{errorName:C.name})]})]}),e.jsxs("div",{className:"grid grid-cols-6 gap-3 md:gap-5 xl:gap-6 lg:gap-6 mb-6",children:[e.jsx(L,{label:t("Description")}),e.jsxs("div",{className:"col-span-8 sm:col-span-4",children:[e.jsx(Z,{register:x,label:"Description",name:"description",type:"text",placeholder:"Category Description"}),e.jsx(k,{errorName:C.description})]})]}),e.jsxs("div",{className:"grid grid-cols-6 gap-3 md:gap-5 xl:gap-6 lg:gap-6 mb-6",children:[e.jsx(L,{label:t("ParentCategory")}),e.jsxs("div",{className:"col-span-8 sm:col-span-4 relative",children:[e.jsx(p.Input,{readOnly:!0,...x("parent",{required:!1}),name:"parent",value:s||"Home",placeholder:t("ParentCategory"),type:"text"}),e.jsxs("div",{className:"draggable-demo capitalize",children:[e.jsx("style",{dangerouslySetInnerHTML:{__html:A}}),e.jsx(le,{expandAction:"click",treeData:U(c),selectedKeys:[j],onSelect:a=>H(a[0]),motion:E,animation:"slide-up"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-6 gap-3 md:gap-5 xl:gap-6 lg:gap-6 mb-6",children:[e.jsx(L,{label:t("CategoryIcon")}),e.jsx("div",{className:"col-span-8 sm:col-span-4",children:e.jsx(me,{imageUrl:b,setImageUrl:w,folder:"category"})})]}),e.jsxs("div",{className:"grid grid-cols-6 gap-3 md:gap-5 xl:gap-6 lg:gap-6 mb-6",children:[e.jsx(L,{label:t("Published")}),e.jsx("div",{className:"col-span-8 sm:col-span-4",children:e.jsx(oe,{handleProcess:u,processOption:D})})]})]}),e.jsx(se,{id:o,title:"Category",isSubmitting:m})]})})]})},Ie=({data:o,lang:c,isCheck:t,categories:j,setIsCheck:x,useParamId:S,showChild:v})=>{const{title:C,serviceId:b,handleModalOpen:w,handleUpdate:D}=ae(),{showingTranslateValue:u}=z(),_=s=>{const{id:r,checked:h}=s.target;x([...t,r]),h||x(t.filter(m=>m!==r))};return e.jsxs(e.Fragment,{children:[(t==null?void 0:t.length)<1&&e.jsx(ne,{useParamId:S,id:b,title:C}),e.jsx(te,{children:e.jsx(ce,{id:b,data:o,lang:c})}),e.jsx(p.TableBody,{children:j==null?void 0:j.map(s=>{var r,h;return e.jsxs(p.TableRow,{children:[e.jsx(p.TableCell,{children:e.jsx(y,{type:"checkbox",name:"category",id:s._id,handleClick:_,isChecked:t==null?void 0:t.includes(s._id)})}),e.jsx(p.TableCell,{className:"font-semibold uppercase text-xs",children:(r=s==null?void 0:s._id)==null?void 0:r.substring(20,24)}),e.jsx(p.TableCell,{children:s!=null&&s.icon?e.jsx(p.Avatar,{className:"hidden mr-3 md:block bg-gray-50 p-1",src:s==null?void 0:s.icon,alt:s==null?void 0:s.parent}):e.jsx(p.Avatar,{src:"https://res.cloudinary.com/ahossain/image/upload/v1655097002/placeholder_kvepfp.png",alt:"product",className:"hidden p-1 mr-2 md:block bg-gray-50 shadow-none"})}),e.jsx(p.TableCell,{className:"font-medium text-sm ",children:(s==null?void 0:s.children.length)>0?e.jsxs(q,{to:`/categories/${s==null?void 0:s._id}`,className:"text-blue-700",children:[u(s==null?void 0:s.name),e.jsx(e.Fragment,{children:v&&e.jsxs(e.Fragment,{children:[" ",e.jsx("div",{className:"pl-2 ",children:(h=s==null?void 0:s.children)==null?void 0:h.map(m=>e.jsx("div",{children:e.jsx(q,{to:`/categories/${m==null?void 0:m._id}`,className:"text-blue-700",children:e.jsxs("div",{className:"flex text-xs items-center  text-blue-800",children:[e.jsx("span",{className:" text-xs text-gray-500 pr-1",children:e.jsx(X,{})}),e.jsx("span",{className:"text-gray-500",children:u(m.name)})]})})},m._id))})]})})]}):e.jsx("span",{children:u(s==null?void 0:s.name)})}),e.jsx(p.TableCell,{className:"text-sm",children:u(s==null?void 0:s.description)}),e.jsx(p.TableCell,{className:"text-center",children:e.jsx(ee,{id:s._id,category:!0,status:s.status})}),e.jsx(p.TableCell,{children:e.jsx(re,{id:s==null?void 0:s._id,parent:s,isCheck:t,children:s==null?void 0:s.children,handleUpdate:D,handleModalOpen:w,title:u(s==null?void 0:s.name)})})]},s._id)})})]})};export{ce as C,Ie as a};
