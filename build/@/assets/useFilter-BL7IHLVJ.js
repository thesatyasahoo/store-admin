import{a as Ye,P as ze,c as Ze,C as $e,b as Ge,d as He,A as Xe}from"./ProductServices-D2PrCWjo.js";import{d as I,u as ke}from"./Layout-JsXqKSFR.js";import{c as le,g as ce}from"./vendor-BzEnyBH3.js";import{r as n,e as Ke,S as Qe}from"./index-njudL7fz.js";import{C as We}from"./CurrencyServices-DaKVcmHd.js";import{L as et}from"./LanguageServices-DiisRc0f.js";import"./httpService-BcSIzyqb.js";import{a as c,n as R}from"./toast-DX8d8eRH.js";var pe={exports:{}};(function(w,O){(function(A,y){w.exports=y()})(le,function(){return function(A,y,h){y.prototype.isBetween=function(x,T,g,C){var P=h(x),p=h(T),_=(C=C||"()")[0]==="(",j=C[1]===")";return(_?this.isAfter(P,g):!this.isBefore(P,g))&&(j?this.isBefore(p,g):!this.isAfter(p,g))||(_?this.isBefore(P,g):!this.isAfter(P,g))&&(j?this.isAfter(p,g):!this.isBefore(p,g))}}})})(pe);var tt=pe.exports;const st=ce(tt);var me={exports:{}};(function(w,O){(function(A,y){w.exports=y()})(le,function(){return function(A,y,h){y.prototype.isToday=function(){var x="YYYY-MM-DD",T=h();return this.format(x)===T.format(x)}}})})(me);var nt=me.exports;const ot=ce(nt),at={type:"object",properties:{_id:{type:"string"},name:{type:"object"},description:{type:"object"},icon:{type:"string"},status:{type:"string"}},required:["name"]},it={type:"object",properties:{status:{type:"string"},title:{type:"object"},name:{type:"object"},variants:{type:"array"},option:{type:"string"},type:{type:"string"}},required:["name","title"]},rt={type:"object",properties:{title:{type:"object"},couponCode:{type:"string"},endTime:{type:"string"},discountPercentage:{type:"number"},minimumAmount:{type:"number"},productType:{type:"string"},logo:{type:"string"},discountType:{type:"object"},status:{type:"string"}},required:["title","couponCode","endTime","status"]},ut={type:"object",properties:{name:{type:"string"},email:{type:"string"}},required:["name","email"]},Nt=w=>{const O=new Ye({allErrors:!0}),[A,y]=n.useState(""),[h,x]=n.useState(""),[T,g]=n.useState(""),[C,P]=n.useState(""),[p,_]=n.useState(""),[j,fe]=n.useState(""),[b,K]=n.useState(""),[L,Q]=n.useState(""),[B,W]=n.useState(""),[ge,Se]=n.useState(""),[U,ye]=n.useState(""),[Y,Ce]=n.useState(""),[we,he]=n.useState([]),[be,Le]=n.useState([]),[De,Ae]=n.useState([]),[z,Te]=n.useState(""),[Z,Pe]=n.useState(""),[v,Re]=n.useState(""),[$,Oe]=n.useState(1),[xe,ee]=n.useState([]),[je,Fe]=n.useState(""),[Ne,_e]=n.useState(""),[Be,Ue]=n.useState(""),[S,G]=n.useState([]),[Je,M]=n.useState(""),[Ee,V]=n.useState(!1),[H,Ie]=n.useState(""),[X]=n.useState([]),te=n.useRef(""),se=n.useRef(""),ne=n.useRef(""),oe=n.useRef(""),ae=n.useRef(""),k=n.useRef(""),ie=n.useRef(""),re=n.useRef(""),ue=n.useRef(""),ve=n.useRef(""),de=n.useRef("");I.extend(st),I.extend(ot);const d=Ke(),{lang:J,setIsUpdate:F,setLoading:m}=n.useContext(Qe),{globalSetting:N}=ke(),D=n.useMemo(()=>{const a=new Date;a.setDate(a.getDate()-v);let t=w==null?void 0:w.map(e=>{const i=new Date(e==null?void 0:e.updatedAt).toLocaleString("en-US",{timeZone:N==null?void 0:N.default_time_zone});return{...e,updatedDate:i==="Invalid Date"?"":i}});if(d.pathname==="/dashboard"){const e=t==null?void 0:t.filter(l=>l.status==="Pending");he(e);const i=t==null?void 0:t.filter(l=>l.status==="Processing");Le(i);const s=t==null?void 0:t.filter(l=>l.status==="Delivered");Ae(s);const u=t==null?void 0:t.filter(l=>I(l.createdAt).isToday()),f=u==null?void 0:u.reduce((l,E)=>l+E.total,0);Fe(f);const o=t==null?void 0:t.filter(l=>I(l.createdAt).isBetween(new Date().setDate(new Date().getDate()-30),new Date)),r=o==null?void 0:o.reduce((l,E)=>l+E.total,0);_e(r);const qe=t==null?void 0:t.reduce((l,E)=>l+E.total,0);Ue(qe)}return A&&(t=t.filter(e=>e.parent===A)),h==="Low"&&(t=t.sort((e,i)=>e.price<i.price&&-1)),h==="High"&&(t=t.sort((e,i)=>e.price>i.price&&-1)),T&&(t=t.filter(e=>{var i;return(i=e==null?void 0:e.title)==null?void 0:i.toLowerCase().includes(T.toLowerCase())})),L&&(t=t.filter(e=>{var i,s,u;return((s=(i=e==null?void 0:e.title[J])==null?void 0:i.toLowerCase())==null?void 0:s.includes(L==null?void 0:L.toLowerCase()))||((u=e==null?void 0:e.attribute)==null?void 0:u.toLowerCase().includes(L==null?void 0:L.toLowerCase()))})),b&&(t=t.filter(e=>{var i,s,u;return((s=(i=e==null?void 0:e.name[J])==null?void 0:i.toLowerCase())==null?void 0:s.includes(b==null?void 0:b.toLowerCase()))||((u=e==null?void 0:e.category)==null?void 0:u.toLowerCase().includes(b==null?void 0:b.toLowerCase()))})),Z&&(t=t.filter(e=>e.role===Z)),C&&(t=t.filter(e=>{var i,s,u;return((i=e==null?void 0:e.name[J])==null?void 0:i.toLowerCase().includes(C.toLowerCase()))||((s=e==null?void 0:e.phone)==null?void 0:s.toLowerCase().includes(C.toLowerCase()))||((u=e==null?void 0:e.email)==null?void 0:u.toLowerCase().includes(C.toLowerCase()))})),p&&(t=t==null?void 0:t.filter(e=>{var i,s,u;return((s=(i=e==null?void 0:e.title[J])==null?void 0:i.toLowerCase())==null?void 0:s.includes(p==null?void 0:p.toLowerCase()))||((u=e==null?void 0:e.couponCode)==null?void 0:u.toLowerCase().includes(p==null?void 0:p.toLowerCase()))})),z&&(t=t.filter(e=>e.status===z)),j&&(t=t.filter(e=>e.contact.toLowerCase().includes(j.toLowerCase()))),v&&(t=t.filter(e=>I(e.createdAt).isBetween(a,new Date))),B&&(t=t.filter(e=>{var i,s;return((i=e==null?void 0:e.name)==null?void 0:i.toLowerCase().includes(B.toLowerCase()))||((s=e==null?void 0:e.iso_code)==null?void 0:s.toLowerCase().includes(B.toLowerCase()))})),H&&(t=t.filter(e=>e==null?void 0:e.name.toLowerCase().includes(H.toLowerCase()))),U&&(t=t.filter(e=>e.name.toLowerCase().includes(U.toLowerCase())||e.iso_code.toLowerCase().includes(U.toLowerCase())||e.language_code.toLowerCase().includes(U.toLowerCase()))),Y&&(t=t.filter(e=>e.iso_code.toLowerCase().includes(Y.toLowerCase()))),t},[v,w,d.pathname,A,h,T,L,b,Z,C,p,z,j,B,H,U,Y,k,N==null?void 0:N.default_time_zone,J]),q=20,Me=D==null?void 0:D.length,Ve=a=>{Oe(a)};return n.useEffect(()=>{ee(D==null?void 0:D.slice(($-1)*q,$*q))},[D,$,q]),{userRef:ne,searchRef:se,couponRef:oe,orderRef:ae,categoryRef:k,attributeRef:ie,pending:we,processing:be,delivered:De,todayOrder:je,monthlyOrder:Ne,totalOrder:Be,setFilter:y,setSortedField:x,setStatus:Te,setRole:Pe,time:v,zone:ge,setTime:Re,taxRef:ve,setZone:Se,filename:Je,countryRef:re,dataTable:xe,serviceData:D,country:B,setSearchText:g,setCountry:W,isDisabled:Ee,languageRef:ue,currencyRef:te,shippingRef:de,setSearchUser:P,setDataTable:ee,setCategoryType:K,handleChangePage:Ve,totalResults:Me,resultsPerPage:q,handleOnDrop:a=>{for(let t=0;t<a.length;t++)X.push(a[t].data)},setSearchCoupon:_,setAttributeTitle:Q,handleSelectFile:a=>{var i;a.preventDefault();const t=new FileReader,e=(i=a.target)==null?void 0:i.files[0];e&&e.type==="application/json"?(M(e==null?void 0:e.name),V(!0),console.log("if"),t.readAsText(e,"UTF-8"),t.onload=s=>{let u=JSON.parse(s.target.result),f=[];d.pathname==="/categories"&&(f=u.map(o=>({_id:o._id,id:o.id,status:o.status,name:o.name,description:o.description,parentName:o.parentName,parentId:o.parentId,icon:o.icon}))),d.pathname==="/attributes"&&(f=u.map(o=>({_id:o._id,status:o.status,title:o.title,name:o.name,variants:o.variants,option:o.option,type:o.type}))),d.pathname==="/coupons"&&(f=u.map(o=>({title:o.title,couponCode:o.couponCode,endTime:o.endTime,discountPercentage:o.discountPercentage,minimumAmount:o.minimumAmount,productType:o.productType,logo:o.logo,discountType:o.discountType,status:o.status}))),d.pathname==="/customers"&&(f=u.map(o=>({name:o.name,email:o.email,password:o.password,phone:o.phone}))),G(f)}):e&&e.type==="text/csv"?(M(e==null?void 0:e.name),V(!0),console.log("else if"),t.onload=async s=>{const u=s.target.result,f=await Ze().fromString(u);let o=[];d.pathname==="/categories"&&(o=f.map(r=>({_id:r._id,id:r.id,status:r.status,name:JSON.parse(r.name),description:JSON.parse(r.description),parentName:r.parentName,parentId:r.parentId,icon:r.icon}))),d.pathname==="/attributes"&&(o=f.map(r=>({status:r.status,title:JSON.parse(r.title),name:JSON.parse(r.name),variants:JSON.parse(r.variants),option:r.option,type:r.type}))),d.pathname==="/coupons"&&(o=f.map(r=>({title:JSON.parse(r.title),couponCode:r.couponCode,endTime:r.endTime,discountPercentage:r.discountPercentage?JSON.parse(r.discountPercentage):0,minimumAmount:r.minimumAmount?JSON.parse(r.minimumAmount):0,productType:r.productType,logo:r.logo,status:r.status}))),d.pathname==="/customers"&&(o=f.map(r=>({name:r.name,email:r.email,password:r.password,phone:r.phone}))),G(o)},t.readAsText(e)):(M(e==null?void 0:e.name),V(!0),c("Unsupported file type!"))},handleSubmitUser:a=>{a.preventDefault(),P(ne.current.value)},handleSubmitForAll:a=>{a.preventDefault(),g(se.current.value)},handleSubmitCoupon:a=>{a.preventDefault(),_(oe.current.value)},handleSubmitOrder:a=>{a.preventDefault(),fe(ae.current.value)},handleSubmitCategory:a=>{a.preventDefault(),K(k.current.value)},handleSubmitAttribute:a=>{a.preventDefault(),Q(ie.current.value)},handleUploadProducts:()=>{X.length<1?c("Please upload/select csv file first!"):ze.addAllProducts(X).then(a=>{R(a.message)}).catch(a=>c(a.message))},handleSubmitCountry:a=>{a.preventDefault(),W(re.current.value)},handleSubmitCurrency:a=>{a.preventDefault(),Ce(te.current.value)},handleSubmitShipping:a=>{a.preventDefault(),Ie(de.current.value)},handleSubmitLanguage:a=>{a.preventDefault(),ye(ue.current.value)},handleUploadMultiple:a=>{if(S.length>1){if(d.pathname==="/categories"){m(!0);let t=S.map(s=>O.validate(at,s));const e=s=>s===!0;t.every(e)?$e.addAllCategory(S).then(s=>{m(!1),F(!0),R(s.message)}).catch(s=>{m(!1),c(s?s.response.data.message:s.message)}):c("Please enter valid data!")}if(d.pathname==="/customers"){m(!0);let t=S.map(s=>O.validate(ut,s));const e=s=>s===!0;t.every(e)?Ge.addAllCustomers(S).then(s=>{m(!1),F(!0),R(s.message)}).catch(s=>{m(!1),c(s?s.response.data.message:s.message)}):c("Please enter valid data!")}if(d.pathname==="/coupons"){m(!0);let t=S.map(s=>O.validate(rt,s));const e=s=>s===!0;t.every(e)?He.addAllCoupon(S).then(s=>{m(!1),F(!0),R(s.message)}).catch(s=>{m(!1),c(s?s.response.data.message:s.message)}):c("Please enter valid data!")}if(d.pathname==="/attributes"){m(!0);let t=S.map(s=>O.validate(it,s));const e=s=>s===!0;t.every(e)?Xe.addAllAttributes(S).then(s=>{m(!1),F(!0),R(s.message)}).catch(s=>{m(!1),c(s?s.response.data.message:s.message)}):c("Please enter valid data!")}d.pathname==="/languages"&&et.addAllLanguage(S).then(t=>{F(!0),R(t.message)}).catch(t=>c(t?t.response.data.message:t.message)),d.pathname==="/currencies"&&We.addAllCurrency(S).then(t=>{F(!0),R(t.message)}).catch(t=>c(t?t.response.data.message:t.message))}else c("Please select a valid .JSON/.CSV/.XLS file first!")},handleRemoveSelectFile:a=>{M(""),G([]),setTimeout(()=>V(!1),1e3)}}};export{ot as a,st as i,Nt as u};
