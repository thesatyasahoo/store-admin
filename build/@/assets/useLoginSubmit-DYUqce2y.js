import{r as S,A as O,i as E,e as I,k as R,b as d}from"./index-DR52bIsS.js";import{u as k}from"./index.esm-BRC1Nkeg.js";import{A as i}from"./AdminServices-C9FUgyYR.js";import{n,a as m}from"./toast-De5mugnc.js";import{u as v}from"./useDispatch-B3QTCHxn.js";const w=()=>{const l=v(),[h,e]=S.useState(!1),{dispatch:c}=S.useContext(O),f=E(),o=I(),{register:y,handleSubmit:x,formState:{errors:b}}=k();return{onSubmit:({name:A,email:p,verifyEmail:L,password:u,role:N})=>{e(!0);const g=.5;o.pathname==="/login"&&(l(R("globalSetting")),i.loginAdmin({email:p,password:u}).then(s=>{s&&(e(!1),n("Login Success!"),c({type:"USER_LOGIN",payload:s}),d.set("adminInfo",JSON.stringify(s),{expires:g,sameSite:"None",secure:!0}),f.replace("/"))}).catch(s=>{var t,a;m(((a=(t=s==null?void 0:s.response)==null?void 0:t.data)==null?void 0:a.message)||(s==null?void 0:s.message)),e(!1)})),o.pathname==="/signup"&&i.registerAdmin({name:A,email:p,password:u,role:N}).then(s=>{s&&(e(!1),n("Register Success!"),c({type:"USER_LOGIN",payload:s}),d.set("adminInfo",JSON.stringify(s),{expires:g,sameSite:"None",secure:!0}),f.replace("/"))}).catch(s=>{var t,a;m(((a=(t=s==null?void 0:s.response)==null?void 0:t.data)==null?void 0:a.message)||(s==null?void 0:s.message)),e(!1)}),o.pathname==="/forgot-password"&&i.forgetPassword({verifyEmail:L}).then(s=>{e(!1),n(s.message)}).catch(s=>{var t,a;e(!1),m(((a=(t=s==null?void 0:s.response)==null?void 0:t.data)==null?void 0:a.message)||(s==null?void 0:s.message))})},register:y,handleSubmit:x,errors:b,loading:h}};export{w as u};
