import{j as e,d as l,t as B,L as Q,r as N,S as I,c as J}from"./index-njudL7fz.js";import{u as R,i as W,e as X,f as Y,g as ee}from"./Layout-JsXqKSFR.js";import{u as M}from"./useAsync-CeSRD30R.js";import{u as _,M as E}from"./DrawerButton-BUY6Djek.js";import{U as se}from"./UploadMany-Bt9vf_tz.js";import{N as le}from"./NotFound-CmKvN8ZP.js";import{a as te,P as O,c as ae,C as ie}from"./ProductServices-D2PrCWjo.js";import{P as re}from"./PageTitle-TKLkvQFL.js";import{P as L}from"./ProductDrawer-BsL73Hz4.js";import{C as V,S as ne,B as oe}from"./BulkActionDrawer-CbBQchGQ.js";import{D as H,E as de}from"./EditDeleteButton-BUM0uXoF.js";import{T as ce}from"./Tooltip-BHhd_jVs.js";import{a as v,n as U}from"./toast-DX8d8eRH.js";import{T as xe}from"./TableLoading-B4Zp0qjg.js";import{A as me}from"./AnimatedContent-D_02SufE.js";import"./vendor-BzEnyBH3.js";import"./iconBase-BovUegyd.js";import"./useDispatch-D0Ya1_uQ.js";import"./httpService-BcSIzyqb.js";import"./SelectLanguageTwo-B_NGHHiw.js";import"./LanguageServices-DiisRc0f.js";import"./spinner-CkndCogW.js";import"./exportFromJSON-fDIoOtpr.js";import"./index-DGmkQahL.js";import"./index-CBoBRqAf.js";import"./ParentCategory-BNQd-o5V.js";import"./index.esm-2x07zYBF.js";import"./InputArea-De5Z0P_G.js";import"./LabelArea-B72Uma4d.js";import"./InputValue-E0WUszOY.js";import"./Uploader-BigpkR8P.js";import"./tslib.es6-BgFQhbLt.js";import"./index.prod-OrM6KnAV.js";import"./CurrencyServices-DaKVcmHd.js";import"./SwitchToggle-D-nBAwTv.js";import"./AdminServices-Dj0irfRq.js";const ge=({products:g,isCheck:n,setIsCheck:m})=>{const{title:T,serviceId:c,handleModalOpen:a,handleUpdate:S}=_(),{currency:p,showingTranslateValue:h,getNumberTwo:f}=R(),b=s=>{const{id:u,checked:w}=s.target;m([...n,u]),w||m(n.filter(y=>y!==u))};return e.jsxs(e.Fragment,{children:[(n==null?void 0:n.length)<1&&e.jsx(H,{id:c,title:T}),(n==null?void 0:n.length)<2&&e.jsx(E,{children:e.jsx(L,{currency:p,id:c})}),e.jsx(l.TableBody,{children:g==null?void 0:g.map((s,u)=>{var w,y,D,C,o,t,i;return e.jsxs(l.TableRow,{children:[e.jsx(l.TableCell,{children:e.jsx(V,{type:"checkbox",name:(w=s==null?void 0:s.title)==null?void 0:w.en,id:s._id,handleClick:b,isChecked:n==null?void 0:n.includes(s._id)})}),e.jsx(l.TableCell,{children:e.jsxs("div",{className:"flex items-center",children:[s!=null&&s.image[0]?e.jsx(l.Avatar,{className:"hidden p-1 mr-2 md:block bg-gray-50 shadow-none",src:s==null?void 0:s.image[0],alt:"product"}):e.jsx(l.Avatar,{src:"https://res.cloudinary.com/ahossain/image/upload/v1655097002/placeholder_kvepfp.png",alt:"product"}),e.jsx("div",{children:e.jsx("h2",{className:`text-sm font-medium ${(s==null?void 0:s.title.length)>30?"wrap-long-title":""}`,children:(y=h(s==null?void 0:s.title))==null?void 0:y.substring(0,28)})})]})}),e.jsx(l.TableCell,{children:e.jsx("span",{className:"text-sm",children:h((D=s==null?void 0:s.category)==null?void 0:D.name)})}),e.jsx(l.TableCell,{children:e.jsxs("span",{className:"text-sm font-semibold",children:[p,s!=null&&s.isCombination?f((C=s==null?void 0:s.variants[0])==null?void 0:C.originalPrice):f((o=s==null?void 0:s.prices)==null?void 0:o.originalPrice)]})}),e.jsx(l.TableCell,{children:e.jsxs("span",{className:"text-sm font-semibold",children:[p,s!=null&&s.isCombination?f((t=s==null?void 0:s.variants[0])==null?void 0:t.price):f((i=s==null?void 0:s.prices)==null?void 0:i.price)]})}),e.jsx(l.TableCell,{children:e.jsx("span",{className:"text-sm",children:s.stock})}),e.jsx(l.TableCell,{children:s.stock>0?e.jsx(l.Badge,{type:"success",children:B("Selling")}):e.jsx(l.Badge,{type:"danger",children:B("SoldOut")})}),e.jsx(l.TableCell,{children:e.jsx(Q,{to:`/product/${s._id}`,className:"flex justify-center text-gray-400 hover:text-emerald-600",children:e.jsx(ce,{id:"view",Icon:W,title:B("DetailsTbl"),bgColor:"#10B981"})})}),e.jsx(l.TableCell,{className:"text-center",children:e.jsx(ne,{id:s._id,status:s.status})}),e.jsx(l.TableCell,{children:e.jsx(de,{id:s._id,product:s,isCheck:n,handleUpdate:S,handleModalOpen:a,title:h(s==null?void 0:s.title)})})]},u+1)})})]})},he={type:"object",properties:{categories:{type:"array"},image:{type:"array"},tag:{type:"array"},variants:{type:"array"},show:{type:"array"},status:{type:"string"},prices:{type:"object"},isCombination:{type:"boolean"},title:{type:"object"},productId:{type:"string"},slug:{type:"string"},category:{type:"object"},stock:{type:"number"},description:{type:"object"}},required:["categories","category","prices","title"]},je=g=>{const n=new te({allErrors:!0}),{setLoading:m,setIsUpdate:T}=N.useContext(I),[c]=N.useState([]),[a,S]=N.useState([]),[p,h]=N.useState(""),[f,b]=N.useState(!1);return{data:g,filename:p,isDisabled:f,handleSelectFile:async o=>{var P;o.preventDefault();const t=new FileReader,i=(P=o.target)==null?void 0:P.files[0];i&&i.type==="application/json"?(h(i==null?void 0:i.name),b(!0),t.readAsText(i,"UTF-8"),t.onload=x=>{const j=JSON.parse(x.target.result).map(r=>({categories:r.categories,image:r.image,barcode:r.barcode,tag:r.tag,variants:r.variants,status:r.status,prices:r.prices,isCombination:JSON.parse(r.isCombination.toLowerCase()),title:r.title,productId:r.productId,slug:r.slug,sku:r.sku,category:r.category,stock:r.stock,description:r.description}));S(j)}):i&&i.type==="text/csv"?(h(i==null?void 0:i.name),b(!0),t.onload=async x=>{const A=x.target.result,r=(await ae().fromString(A)).map(d=>({categories:JSON.parse(d.categories),image:JSON.parse(d.image),barcode:d.barcode,tag:JSON.parse(d.tag),variants:JSON.parse(d.variants),status:d.status,prices:JSON.parse(d.prices),isCombination:JSON.parse(d.isCombination.toLowerCase()),title:JSON.parse(d.title),productId:d.productId,slug:d.slug,sku:d.sku,category:JSON.parse(d.category),stock:JSON.parse(d.stock),description:JSON.parse(d.description)}));S(r)},t.readAsText(i)):(h(i==null?void 0:i.name),b(!0),v("Unsupported file type!"))},serviceData:g,handleOnDrop:o=>{for(let t=0;t<o.length;t++)c.push(o[t].data)},handleUploadProducts:()=>{c.length<1?v("Please upload/select csv file first!"):O.addAllProducts(c).then(o=>{U(o.message)}).catch(o=>v(o.message))},handleRemoveSelectFile:o=>{h(""),S([]),setTimeout(()=>b(!1),1e3)},handleUploadMultiple:o=>{if(a.length>1){m(!0);let t=a.map(x=>n.validate(he,x));const i=x=>x===!0;t.every(i)?O.addAllProducts(a).then(x=>{T(!0),m(!1),U(x.message)}).catch(x=>{m(!1),v(x.message)}):(m(!1),v("Please enter valid data!"))}else m(!1),v("Please select a valid json, csv & xls file first!")}}},pe=({setCategory:g})=>{const{t:n}=J(),{data:m}=M(ie.getAllCategories),{showingTranslateValue:T}=R();return e.jsx(e.Fragment,{children:e.jsxs(l.Select,{onChange:c=>g(c.target.value),children:[e.jsx("option",{value:"All",defaultValue:!0,hidden:!0,children:n("Category")}),m==null?void 0:m.map(c=>e.jsx("option",{value:c._id,children:T(c==null?void 0:c.name)},c._id))]})})},Ye=()=>{const{title:g,allId:n,serviceId:m,handleDeleteMany:T,handleUpdateMany:c}=_(),{t:a}=J(),{toggleDrawer:S,lang:p,currentPage:h,handleChangePage:f,searchText:b,category:s,setCategory:u,searchRef:w,handleSubmitForAll:y,sortedField:D,setSortedField:C,limitData:o}=N.useContext(I),{data:t,loading:i,error:P}=M(()=>O.getAllProducts({page:h,limit:o,category:s,title:b,price:D})),[x,A]=N.useState(!1),[j,r]=N.useState([]),d=()=>{A(!x),r(t==null?void 0:t.products.map(k=>k._id)),x&&r([])},$=()=>{u(""),C(""),w.current.value=""},{serviceData:F,filename:q,isDisabled:Z,handleSelectFile:z,handleUploadMultiple:G,handleRemoveSelectFile:K}=je(t==null?void 0:t.products);return e.jsxs(e.Fragment,{children:[e.jsx(re,{children:a("ProductsPage")}),e.jsx(H,{ids:n,setIsCheck:r,title:g}),e.jsx(oe,{ids:n,title:"Products"}),e.jsx(E,{children:e.jsx(L,{id:m})}),e.jsxs(me,{children:[e.jsx(l.Card,{className:"min-w-0 shadow-xs overflow-hidden bg-white dark:bg-gray-800 mb-5",children:e.jsx(l.CardBody,{className:"",children:e.jsxs("form",{onSubmit:y,className:"py-3 md:pb-0 grid gap-4 lg:gap-6 xl:gap-6 xl:flex",children:[e.jsx("div",{className:"flex-grow-0 sm:flex-grow md:flex-grow lg:flex-grow xl:flex-grow",children:e.jsx(se,{title:"Products",filename:q,isDisabled:Z,totalDoc:t==null?void 0:t.totalDoc,handleSelectFile:z,handleUploadMultiple:G,handleRemoveSelectFile:K})}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsx("div",{className:"flex-grow-0 md:flex-grow lg:flex-grow xl:flex-grow",children:e.jsxs(l.Button,{disabled:j.length<1,onClick:()=>c(j),className:"w-full rounded-md h-12 btn-gray text-gray-600",children:[e.jsx("span",{className:"mr-2",children:e.jsx(X,{})}),a("BulkAction")]})}),e.jsx("div",{className:"flex-grow-0 md:flex-grow lg:flex-grow xl:flex-grow",children:e.jsxs(l.Button,{disabled:(j==null?void 0:j.length)<1,onClick:()=>T(j,t.products),className:"w-full rounded-md h-12 bg-red-300 disabled btn-red",children:[e.jsx("span",{className:"mr-2",children:e.jsx(Y,{})}),a("Delete")]})}),e.jsx("div",{className:"flex-grow-0 md:flex-grow lg:flex-grow xl:flex-grow",children:e.jsxs(l.Button,{onClick:S,className:"w-full rounded-md h-12",children:[e.jsx("span",{className:"mr-2",children:e.jsx(ee,{})}),a("AddProduct")]})})]})]})})}),e.jsx(l.Card,{className:"min-w-0 shadow-xs overflow-hidden bg-white dark:bg-gray-800 rounded-t-lg rounded-0 mb-4",children:e.jsx(l.CardBody,{children:e.jsxs("form",{onSubmit:y,className:"py-3 grid gap-4 lg:gap-6 xl:gap-6 md:flex xl:flex",children:[e.jsxs("div",{className:"flex-grow-0 md:flex-grow lg:flex-grow xl:flex-grow",children:[e.jsx(l.Input,{ref:w,type:"search",name:"search",placeholder:"Search Product"}),e.jsx("button",{type:"submit",className:"absolute right-0 top-0 mt-5 mr-1"})]}),e.jsx("div",{className:"flex-grow-0 md:flex-grow lg:flex-grow xl:flex-grow",children:e.jsx(pe,{setCategory:u,lang:p})}),e.jsx("div",{className:"flex-grow-0 md:flex-grow lg:flex-grow xl:flex-grow",children:e.jsxs(l.Select,{onChange:k=>C(k.target.value),children:[e.jsx("option",{value:"All",defaultValue:!0,hidden:!0,children:a("Price")}),e.jsx("option",{value:"low",children:a("LowtoHigh")}),e.jsx("option",{value:"high",children:a("HightoLow")}),e.jsx("option",{value:"published",children:a("Published")}),e.jsx("option",{value:"unPublished",children:a("Unpublished")}),e.jsx("option",{value:"status-selling",children:a("StatusSelling")}),e.jsx("option",{value:"status-out-of-stock",children:a("StatusStock")}),e.jsx("option",{value:"date-added-asc",children:a("DateAddedAsc")}),e.jsx("option",{value:"date-added-desc",children:a("DateAddedDesc")}),e.jsx("option",{value:"date-updated-asc",children:a("DateUpdatedAsc")}),e.jsx("option",{value:"date-updated-desc",children:a("DateUpdatedDesc")})]})}),e.jsxs("div",{className:"flex items-center gap-2 flex-grow-0 md:flex-grow lg:flex-grow xl:flex-grow",children:[e.jsx("div",{className:"w-full mx-1",children:e.jsx(l.Button,{type:"submit",className:"h-12 w-full bg-emerald-700",children:"Filter"})}),e.jsx("div",{className:"w-full mx-1",children:e.jsx(l.Button,{layout:"outline",onClick:$,type:"reset",className:"px-4 md:py-1 py-2 h-12 text-sm dark:bg-gray-700",children:e.jsx("span",{className:"text-black dark:text-gray-200",children:"Reset"})})})]})]})})})]}),i?e.jsx(xe,{row:12,col:7,width:160,height:20}):P?e.jsx("span",{className:"text-center mx-auto text-red-500",children:P}):(F==null?void 0:F.length)!==0?e.jsxs(l.TableContainer,{className:"mb-8 rounded-b-lg",children:[e.jsxs(l.Table,{children:[e.jsx(l.TableHeader,{children:e.jsxs("tr",{children:[e.jsx(l.TableCell,{children:e.jsx(V,{type:"checkbox",name:"selectAll",id:"selectAll",isChecked:x,handleClick:d})}),e.jsx(l.TableCell,{children:a("ProductNameTbl")}),e.jsx(l.TableCell,{children:a("CategoryTbl")}),e.jsx(l.TableCell,{children:a("PriceTbl")}),e.jsx(l.TableCell,{children:"Sale Price"}),e.jsx(l.TableCell,{children:a("StockTbl")}),e.jsx(l.TableCell,{children:a("StatusTbl")}),e.jsx(l.TableCell,{className:"text-center",children:a("DetailsTbl")}),e.jsx(l.TableCell,{className:"text-center",children:a("PublishedTbl")}),e.jsx(l.TableCell,{className:"text-right",children:a("ActionsTbl")})]})}),e.jsx(ge,{lang:p,isCheck:j,products:t==null?void 0:t.products,setIsCheck:r})]}),e.jsx(l.TableFooter,{children:e.jsx(l.Pagination,{totalResults:t==null?void 0:t.totalDoc,resultsPerPage:o,onChange:f,label:"Product Page Navigation"})})]}):e.jsx(le,{title:"Product"})]})};export{Ye as default};
